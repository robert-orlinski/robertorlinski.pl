---
title: Jak usuwa style oraz skrypty, pobierane przez wtyczki (i motywy) w WordPressie?
seTitle: Jak usuwa style oraz skrypty wtyczek w WordPressie?
abstract: kontrola-zasobow-pobieranych-przez-wtyczki
isPublished: true
topics:
  - WordPress
date: 23.11.2020
isPopular: false
---

Wiadomo jak to jest z tymi wtyczkami.

Najchtniej, nie u偶ywalibymy ani jednej, bo czym ich wicej, tym z reguy wolniejsza strona, tym wicej podatnoci w konkretnym serwisie i wreszcie wiksza potrzeba dbania o niego - chocia偶by przez regularne aktualizacje, czy odnawianie licencji, w przypadku tych patnych plugin贸w.

[yt id=hNaLeFaJVnA\]

Ale jest te偶 inna kategoria sytuacji.

S to te, w kt贸rych instalujemy (sprawdzone) wtyczki, kt贸re znacznie usprawniaj nasz prac, przy tworzeniu witryny lub prac klienta lub przyszego administratora, przy zarzdzaniu sam stron. A jednoczenie same w sobie, s po prostu dobrym kawakiem kodu.

> Jedna uwaga na sam pocztek - w artykule oraz filmie, odnosz si do wtyczek, ale oczywicie nic nie stoi na przeszkodzie, aby sposoby podane tu, zastosowa r贸wnie偶 dla og贸lnodostpnych motyw贸w!
>
> To tak gwoli cisoci 

## W takich sytuacjach czsto, mimo wszystko, nie wymylamy koa na nowo i decydujemy si na dan wtyczk

Przykadem takiego pluginu, bdzie znany caemu wiatu Contact Form 7.

Ogrom stron, korzysta z jego dobrodziejstw, do tego stopnia, 偶e nawet klienci, czsto go preferuj, ze wzgldu na to, 偶e po prostu znaj ju偶 jego interfejs.

Tylko w przypadku Contact Form 7, jak i wielu innych wtyczek, nie zawsze chcemy, aby ich domylne style, czy te偶 skrypty, byy adowane, aby po prostu - nie obci偶a strony kodem, kt贸ry niekoniecznie zostanie u偶yty albo bdzie musia zosta na si nadpisany.

I tak w przypadku wspomnianego pluginu do formularzy, ja zawsze usuwam domylne style. I tak og贸lnie, jestem niemaym fanem usuwania wielu domylnych asset贸w z wtyczek. Oczywicie tych, kt贸re nie ograbiaj samych plugin贸w, z ich funkcjonalnoci.

## No dobrze, wstp wstpem. Sprawd藕my jak to si robi!

Postanowiem, przygotowa na ten cel, czystego WordPressa, do kt贸rego doinstalowaem dwie z grona najpopularniejszych wtyczek:

![](./wtyczki.jpg)

Pierwsza rzecz, kt贸r trzeba bdzie tutaj zrobi, to w og贸le dowiedzie si, co dokadnie, jest adowane na tej stronie i jak nazw ma to w WordPressie (jak mo偶esz przeczyta w [jednym z moich starszych wpis贸w](./artykuly/jak-stworzyc-motyw-wordpress-006), zwizanych z tworzeniem wasnego motywu WordPress, ka偶dy asset, podpity pod WordPressa, ma wasn nazw, tzw `handle`.

Aby tego dokona potrzebujemy takiego oto kodu, kt贸ry wywietli wszystkie assety, podpite pod aktualnie wywietlany widok w WordPressie:

```php
// functions.php

function get_all_stylesheets() {
    global $wp_styles;

	echo 'Style:<br><br>';
    print_r( $wp_styles->queue );
	echo '';
}
add_action( 'wp_print_styles', 'get_all_stylesheets' );

function get_all_scripts() {
    global $wp_scripts;

	echo 'Skrypty:<br><br>';
    print_r( $wp_scripts->queue );
	echo '';
}
add_action( 'wp_print_scripts', 'get_all_scripts' );
```

Owe dwie funkcje, wywietl nam, wszystkie podpite skrypty JS oraz style CSS, na g贸rze samej strony zaraz przed miejscem w sekcji `<head></head>` caej strony.

> Oczywicie tagi `<pre></pre>` oraz nag贸wek wraz z tagami `<br />`, zostay dodane tylko po to, aby wywietlona lista, wygldaa bardziej estetycznie - nie s one niezbdne.

I jak jestemy przy wygldzie caoci, to koniec koc贸w, naszym oczom, mog ukaza si obiecane nazwy, podpitych asset贸w:

![](./wszystkie-zasoby.jpg)

Huh, sporo tego.

Co dla nas najwa偶niejsze - oba pluginy, pobieraj cznie 6 arkuszy styl贸w oraz 4 pliki JS, i to pomimo faktu, 偶e 偶aden nie jest realnie u偶ywany, na tej konkretnej podstronie (w tym przypadku - stronie g贸wnej motywu Twenty Twenty)!

Wic tak, definitywnie trzeba co z tym zrobi.

Zostawmy ten konkretny kod, aby na bie偶co wiedzie, czy nasze usuwanie konkretnych asset贸w, przynosi skutek i przejd藕my wanie do tej czynnoci.

![](./klawiatura.jpg)

## To jak mo偶emy usun jakikolwiek skrypt JS lub styl CSS, z konkretnej strony?

Ju偶 odpowiadam - za pomoc dw贸ch, do podobnych funkcji, przypitych do hooku `wp_enqueue_scripts()`.

```php
// functions.php

function remove_plugin_assets() {
	wp_dequeue_style( 'contact-form-7' );
	wp_dequeue_script( 'wc-cart-fragments' );
}
add_action( 'wp_enqueue_scripts', 'remove_plugin_assets', 999 );
```

Pierwsza z nich, wp_dequeue_style odpina konkretny styl (identyfikowany nazw, kt贸r zdobylimy w poprzednim akapicie, wpisan w nawiasie). W tym przypadku odpilimy style wtyczki Contact Form 7.

Druga z kolei, analogicznie, odpina skrypty. Tutaj wyrzucilimy z naszej strony plik pobierany przez plugin WooCommerce.

> O czym warto jeszcze wspomnie, to warto 999, na kocu czsto nie bdzie niezbdna. Po prostu, akcje, podpinajce konkretne style (z poziomu wtyczek), czasami maj ustawiony priorytet wikszy, ni偶 standardowe 10, przez co, ustawiajc go, jako bardzo du偶 liczb, mamy pewno, 偶e nasze assety zawsze zostan odpite.

I tak oto, sp贸jrzmy na list z pocztku artykuu:

![](./zasoby-po-usunieciu.jpg)

C贸偶 tu du偶o m贸wi - cel osignity!

## A co w sytuacji, gdy konkretny asset, chcemy odpi dla konkretnej strony, grupy podstron, wpisu lub czegokolwiek innego?

Nic prostszego!

Wystarczy, do utworzonej ju偶 funkcji, doda odpowiedni warunek. Na przykad, jeli wspomniana dw贸jka plik贸w, miaaby zosta odpita tylko na strony g贸wnej, to cao, wygldaaby w ten spos贸b:

```php
// functions.php

function remove_plugin_assets() {
  	if( is_front_page() ) {
        wp_dequeue_style( 'contact-form-7' );
        wp_dequeue_script( 'wc-cart-fragments' );
    }
}
add_action( 'wp_enqueue_scripts', 'remove_plugin_assets', 999 );
```

Tym oto sposobem, gdybymy chcieli na przykad odpi wszystkie assety, zwizane z WooCommerce, na stronie g贸wnej oraz stronie bloga (bo te 2 strony, nie maj w danej chwili 偶adnej stycznoci z funkcjami sklepu), to moglibymy skorzysta z takiego skrawka kodu:

```php
// functions.php

function remove_plugin_assets() {
  	if( is_front_page() || is_home() ) {
		wp_dequeue_style( array(
			'wp-block-library',
			'wc-block-style',
			'woocommerce-layout',
			'woocommerce-smallscreen',
			'woocommerce-inline',
			'woocommerce-general'
		) );

		wp_dequeue_script( array(
			'wc-add-to-cart',
			'woocommerce',
			'wc-cart-fragments'
		) );
	}
}
add_action( 'wp_enqueue_scripts', 'remove_plugin_assets', 999 );
```

Dodatkowo, jak atwo mo偶esz zauwa偶y, parametrami funkcji odpinajcych poszczeg贸lne assety, mog r贸wnie偶 by r贸wnie偶 tablice, wic nie ma 偶adnego problemu, aby wyrzuci z konkretnego miejsca w serwisie, wicej skrypt贸w lub arkuszy, za pomoc pojedynczej funkcji!

## I to tyle na dzi!

WordPress, na nasze (oraz stron tworzonych przez nas) szczcie, pozwala do dobrze kontrolowa, jaki kod, adowany jest przez wszelkie wtyczki oraz motywy. A dziki temu, mo偶emy tworzy sprawniej dziaajce witryny!

Mam nadziej, 偶e wiedza z tego artykuu, przyda si, aby z Twojej rki, powstaway tylko takie 
