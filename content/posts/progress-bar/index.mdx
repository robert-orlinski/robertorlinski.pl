---
title: Pasek postpu, kt贸ry rozszerza si podczas przewijania strony internetowej
abstract: W tym artykule, pokazuj jak u偶y jzyka JavaScript do wykonania efektu paska, kt贸ry rozwija sipodczas przewijania strony.
isPublished: true
topics:
  - Front-end
date: 13.10.2021
isPopular: false
---

Skoro przegldasz tego bloga, to jest spore prawdopodobiestwo, 偶e ledzisz r贸wnie偶 inne, na kt贸rych mo偶na spotka si z do ciekawym efektem. Chodzi o pasek postpu, zapeniajcy si wraz z przewijaniem konkretnej witryny.

Wanie w tym wpisie chciabym pokaza Ci jak w nieskomplikowany spos贸b mo偶na stworzy co podobnego. Wszystko wykonamy w czystym JavaScriptcie!

Demo mo偶esz podejrze ju偶 od razu, w tym oto miejscu:

import CodePenIframe from 'CodePenIframe';

<CodePenIframe id="WNEbpKP" title="Progress Bar" />

## Szkielet HTML

Wszystko zaczyna si od struktury HTML. W tym przypadku jest do prosta, a wyglda dokadnie w ten spos贸b:

```html
<progress class="progress-bar" id="progress-bar" max="100" value="0">
  Strona przewinita w 0 %
</progress>
```

U偶ywamy tutaj semantycznego znacznika [`<progress />`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/progress), kt贸ry zaraz ostylujemy, a p贸藕niej o偶ywimy za pomoc JavaScriptu. Ustawiamy mu klas, po kt贸rej bdziemy stylowa, id, po kt贸rym zapiemy go w JSie oraz maksymaln warto, kt贸ra r贸wna bdzie przewiniciu strony w 100%.

Dodatkowo ustawiamy warto pocztkow zapenienia naszego paska na 0 i tekst, kt贸ry poka偶e si, gdy kto wejdzie na nasz stron z przegldarki, kt贸ra nie obsuguje elementu `<progress />`.

## Kod CSS

Zawiera si w tych oto liniach:

```scss
.progress-bar {
  position: fixed;
  width: 100%;
  height: 6px;
  top: 0;
  left: 0;

  border: none;

  background-color: transparent;

  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;

  &::-webkit-progress-bar {
    background-color: transparent;
  }

  &::-webkit-progress-value {
    background-color: #0091ea;
  }

  &::-moz-progress-bar {
    background-color: #0091ea;
  }
}
```

Na pocztku stylujemy kontener, w kt贸rym zawiera si nasz progress bar - pozycjonujemy go w taki spos贸b, aby cay czas znajdowa si na samej g贸rze okna przegldarki.

Reszta to usunicie domylnych styli przegldarek oraz ustawienie przezroczystego koloru dla niewypenionej czci paska, jak i niebieskiego dla wypenionej.

## Cz najwa偶niejsza - kod JavaScript

Posiadamy ju偶 kod HTML oraz CSS, wic teraz pora sprawi, aby nasz pasek zacz dziaa w po偶dany spos贸b. Poka偶 Ci cay kod, a p贸藕niej om贸wimy go sobie krok po kroku:

```js
const progressBar = document.querySelector('#progress-bar');

const documentHeight = document.documentElement.offsetHeight;
const windowHeight = window.innerHeight;

const updateProgressBar = () => {
  const windowTopEdge = window.scrollY;
  const totalScroll = (windowTopEdge / (documentHeight - windowHeight)) * 100;
  const totalScrollRounded = totalScroll.toFixed(2);

  progressBar.setAttribute('value', totalScrollRounded);
  progressBar.textContent = `Strona przewinita w ${totalScrollRounded} %`;
};

window.addEventListener('scroll', updateProgressBar);
updateProgressBar();
```

Pozwol sobie pomin pierwsze 7 linii, bo nazwy zmiennych wydaj si m贸wi same za siebie 

Ale za to mo偶emy pochyli si nad tym oto kr贸tkim wzorem:

```js
const totalScroll = (windowTopEdge / (documentHeight - windowHeight)) * 100;
```

Przeled藕my go po kolei.

W najgbszej jego czci, znale藕 mo偶emy proste odejmowanie wysokoci okna przegldarki, od wysokoci dokumentu. Dziki temu, gdy dojedziemy do koca naszej strony, nasz progress bar nie poka偶e wartoci poni偶ej 100% (w kocu g贸rna krawd藕 przegldarki nie znajduje si na samej dole strony), a r贸wniutkie 100%.

Oczywicie przy zao偶eniu, 偶e zapiszemy reszt oblicze, czyli gdy przez otrzyman z odejmowania warto podzielimy odlego g贸rnej krawdzi naszego okna od pocztku dokumentu.

W ten spos贸b otrzymamy warto mniejsz od 1, kt贸r w tej chwili wystarczy pomno偶y razy 100, aby otrzyma dokadny postp scrollowania, wyra偶ony ju偶 w procentach.

Natomiast! Procenty te s bardzo dokadne i podczas scrollowania otrzymujemy wartoci ze spor iloci liczb po przecinku, std przyda nam si kolejna linia, kt贸ra zaokrgli je tylko do dw贸ch cyfr:

```js
const totalScrollRounded = totalScroll.toFixed(2);
```

Reszta jest ju偶 prostym kodem, kt贸ry aktualizuje nasz progress bar, o aktualny stopie przescrollowania witryny:

```js
progressBar.setAttribute('value', totalScrollRounded);
progressBar.textContent = `Strona przewinita w ${totalScrollRounded} %`;
```

A na koniec podpinamy nasz funkcj pod event scroll oraz dodatkowo wykonujemy, aby zapewni waciw warto scrolla dla osoby, kt贸ra trafia na stron w na przykad jej poowie, a nie od samego pocztku:

```js
window.addEventListener('scroll', updateProgressBar);
updateProgressBar();
```

I to bdzie z mojej strony na tyle, bo nasz progress bar dziaa 

Ale! Jeli tylko chcesz, to zawsze mo偶esz ulepszy zaproponowany przeze mnie skrypt. Mianowicie:

- Zastosowa [throttling](https://developer.mozilla.org/en-US/docs/Web/API/Document/scroll_event#scroll_event_throttling) dla naszej funkcji, aby ogranicza moc obliczeniow przegldarki, potrzebn do obsu偶enia naszego efektu. Natomiast z maym pogorszeniem tego, jak pynnie wypenia si nasz pasek.
- Obsu偶y sytuacj, w kt贸rej osoba korzystajca z Twojej strony, zmieni wielko przegldarki, ju偶 po zaadowaniu witryny (z racji, 偶e w moim przykadzie wielkoci okna przegldarki, jak i dokumentu deklaruj tylko raz - podczas adowania strony).

## Podsumowanie

Tak oto powsta nasz pasek postpu!

Na koniec podrzucam jeszcze raz demo z pocztku i powolutku bd Ci ju偶 偶egna:

<CodePenIframe id="WNEbpKP" title="Progress Bar" />

Tak偶e mam nadziej, 偶e ten poradnik, jak i sam efekt, oka偶e si dla Ciebie przydatny i urozmaici tworzone przez Ciebie strony internetowe 
