---
title: 'WÅ‚asne bloki w WordPress Gutenberg #008 â€“ panel boczny (sidebar)'
seoTitle: Panel boczny (sidebar) w WordPress Gutenberg
abstract: Tym razem nauczymy siÄ™ edycji panelu bocznego w Gutenbergu, aby mÃ³c dostosowaÄ‡Â go do spisu treÅ›ci, tworzonego w ramach kursu ğŸ‰
isPublished: true
topics:
  - WordPress
  - WÅ‚asne bloki w WordPress Gutenberg
date: 02.11.2021
isPopular: false
menuOrder: 0
---

W czÄ™Å›ci 5 i 6 tej serii, o Toolbarze i Format API, zajmowaliÅ›my siÄ™ edycjÄ… paska gÃ³rnego naszego blogu Gutenberga. DziÅ› natomiast, zbudujemy podwaliny pod edycjÄ™ paska bocznego!

TakÅ¼e bez zbÄ™dnego przedÅ‚uÅ¼ania - dziaÅ‚ajmy!

import VideoInterlude from 'VideoInterlude';

<VideoInterlude
  id="a6CtXekVir8"
  title="WÅ‚asne bloki w WordPress Gutenberg #008 â€“ panel boczny (sidebar)"
/>

## Ale zanim to - rozwiÄ…zania dwÃ³ch zadaÅ„ domowych z przedostatniej czÄ™Å›ci!

### Zadanie domowe numer 1

> SprÃ³buj uÅ¼yÄ‡ naszego nowego formatu (lub jakiegokolwiek innego) dla nagÅ‚Ã³wka naszego spisu treÅ›ci i zobacz, co dzieje siÄ™ na front-endzie. Podpowiem, Å¼e problem wyÅ›wietlania siÄ™ tagÃ³w HTMLa leÅ¼y w deklaracji atrybutÃ³w samego bloku.

Tak jak byÅ‚o widaÄ‡ [w filmie na YouTubie](https://youtu.be/UkKRCGuNOWY), problem polegaÅ‚ na uciekaniu tagÃ³w HTML, uÅ¼ytych dla tytuÅ‚u naszego spisu treÅ›ci:

![Panel](./problem.jpg)

Tych samych tagÃ³w, jak na przykÅ‚ad dodaje nasz przycisk do zakreÅ›lenia czÄ™Å›ci tekstu (przykÅ‚ad na zrzucie powyÅ¼ej) lub opcje wbudowane juÅ¼ z samego Gutenberga (np. pogrubienie tekstu lub kursywa).

A rozwiÄ…zaÄ‡ moÅ¼na to dwojako:

Tak jak sugerowaÅ‚em w treÅ›ci artykuÅ‚u i na filmie, moÅ¼esz lekko zmieniÄ‡ atrybut tytuÅ‚u - dokÅ‚adnie podmieniÄ‡ wartoÅ›Ä‡ parametru `source` z `html`, na `children`:

```js
attributes: {
  title: {
    type: 'string',
    source: 'children',
    selector: 'h2',
  },
  // ...
},
```

DrugÄ… opcjÄ… z kolei jest uÅ¼ycie atrybutu `dangerouslySetInnerHTML` w kodzie nagÅ‚Ã³wka, uÅ¼ywanym na front-endzie, w ten oto sposÃ³b:

```js
return (
  <div class="table-of-contents-block">
    <h2 dangerouslySetInnerHTML={{ __html: title }} />
    <RichText.Content tagName="ol" value={list} />
  </div>
);
```

...natomiast to rozwiÄ…zanie zawsze bÄ™dzie trochÄ™ sÅ‚absze.

Pomimo, Å¼e w tym przypadku uÅ¼ycie tej metody nie niesie za sobÄ…Â wiÄ™kszych zagroÅ¼eÅ„, niÅ¼Â sposÃ³b pierwszy, to dobrze jest siÄ™Â przyzwyczajaÄ‡Â do nieuÅ¼ywania jej - nie jest to dobra praktyka, bo potrafi te zagroÅ¼enia nieÅ›Ä‡, szczegÃ³lnie gdy piszemy bardziej rozbudowane bloki lub tworzymy coÅ›Â w Reactcie, bÄ™dÄ…cym podstawÄ…Â Gutenberga.

I poza tym, jeszcze w ramach trzeciej moÅ¼liwoÅ›ci, moÅ¼emy skorzystaÄ‡Â z komponentu `<RichText.Content />` dla tytuÅ‚u, podobnie jak robimy to dla listy pod nim ğŸ‰

W ten sposÃ³b:

```jsx
return (
  <div class="table-of-contents-block">
    <RichText.Content tagName="h2" value={title} />
    <RichText.Content tagName="ol" value={list} />
  </div>
);
```

Wtedy ÅºrÃ³dÅ‚em naszego atrybutu title nie musi byÄ‡ juÅ¼ children, a bardziej intuicyjny html, tak samo jak w przypadku skorzystania z `dangerouslySetInnerHTML`.

### Zadanie domowe numer 2:

> Dowiedz siÄ™ (i przetestuj), w jaki sposÃ³b moÅ¼na ograniczyÄ‡ wyÅ›wietlanie naszego przycisku, tylko do konkretnego komponentu (na przykÅ‚ad naszego spisu treÅ›ci). Bo obecnie, jak moÅ¼esz zauwaÅ¼yÄ‡, dodany przycisk aplikuje siÄ™ dla spisu streÅ›ci, ale teÅ¼ wszystkich innych elementÃ³w tekstowych w Gutenbergu: nagÅ‚Ã³wkÃ³w, paragrafÃ³w, list itp.
>
> Do tego na pewno przyda Ci siÄ™ [link z dokumentacji Format API](https://developer.wordpress.org/block-editor/how-to-guides/format-api/2-toolbar-button/).

Aby tego dokonaÄ‡ i wyÅ›wietlaÄ‡ omawiany wtedy przycisk tylko dla tworzonego spisu treÅ›ci, kod naszej funkcji `HighlightButton`, musielibyÅ›my przerobiÄ‡ mniej wiÄ™cej w ten sposÃ³b:

```js
const HighlightButton = (props) => {
  const selectedBlock = useSelect((select) => {
    return select('core/block-editor').getSelectedBlock();
  }, []);

  if (selectedBlock && selectedBlock.name !== 'rob/table-of-contents') {
    return null;
  }

  return (
    <BlockControls>
      <Toolbar>
        <ToolbarButton
          label="Zaznaczenie"
          className="highlight-button"
          onClick={() => {
            props.onChange(toggleFormat(props.value, { type: 'custom-formats/highlight' }));
          }}
          isActive={props.isActive}
        >
          <Icon icon="admin-customizer" />
        </ToolbarButton>
      </Toolbar>
    </BlockControls>
  );
};
```

...dodatkowo importujÄ…c metodÄ™ `useSelect` na gÃ³rze pliku, w ktÃ³rym jesteÅ›my:

```js
import { useSelect } from '@wordpress/data';
```

Null zwracamy przed instrukcjÄ… `return`, w tym przypadku dla wszystkich blokÃ³w innych, niÅ¼ nasz niestandardowy spis treÅ›ci (czyli przycisk pokazujemy tylko dla wspomnianego spisu treÅ›ci), ale moÅ¼emy zwrÃ³ciÄ‡ go dla mniejszej iloÅ›ci blokÃ³w lub tylko dla wybranych.

ListÄ™ wszystkich blokÃ³w wbudowanych juÅ¼ w Gutenberga (ktÃ³re moÅ¼esz chcieÄ‡ w tym warunku uÅ¼yÄ‡, aby przycisk dla nich wyÅ›wietliÄ‡ lub go schowaÄ‡), znajdziesz w [poprzedniej czÄ™Å›ci tego kursu](/wordpress-gutenberg-007).

PozwolÄ™ sobie nie tÅ‚umaczyÄ‡ tego kodu mocniej, bo doÅ›Ä‡ solidnie rozgadaÅ‚em siÄ™ o nim w [wersji wideo tego artykuÅ‚u](https://youtu.be/a6CtXekVir8). CaÅ‚ym sobÄ… CiÄ™ zapraszam do zerkniÄ™cia na niÄ…!

## Huh, mamy to. To teraz zajmijmy siÄ™ wymienionym w tytule panelem bocznym!

Na poczÄ…tku zaimportujmy sobie 2 komponenty, na gÃ³rze naszego pliku:

```js
import { InspectorControls } from '@wordpress/block-editor';
import { PanelBody } from '@wordpress/components';
```

JeÅ›li pracujesz rÃ³wno z ze mnÄ…, to wszystkie Twoje importy, bÄ™dÄ… wyglÄ…daÄ‡ teraz mniej wiÄ™cej tak:

```js
import './index.scss';

import { registerBlockType } from '@wordpress/blocks';
import { RichText, BlockControls, InspectorControls } from '@wordpress/block-editor';
import { Toolbar, ToolbarButton, Icon, PanelBody } from '@wordpress/components';
import { registerFormatType, toggleFormat } from '@wordpress/rich-text';
```

A pÃ³Åºniej, na poczÄ…tku instrukcji `return` (zaraz po [reactowym fragmencie](https://reactjs.org/docs/fragments.html), ktÃ³ry przy okazji dodaÅ‚em, aby zwrÃ³ciÄ‡ 2 elementy obok siebie z metody `registerBlockType`), dodajemy przestrzeÅ„ edytowalnÄ… panelu bocznego:

```js
return (
  <>
    <InspectorControls></InspectorControls
   	// Kod spisu treÅ›ci...
```

...do ktÃ³rej teraz moÅ¼emy dodawaÄ‡ zakÅ‚adki (ile nam siÄ™ Å¼ywnie podoba), dziÄ™ki komponentowi `<PanelBody />`:

```js
return (
  <>
    <InspectorControls>
      <PanelBody title="TytuÅ‚ pierwszej zakÅ‚adki">
        <p>TreÅ›Ä‡ pierwszej zakÅ‚adki</p>
      </PanelBody>
      <PanelBody title="TytuÅ‚ pierwszej zakÅ‚adki">
        <p>TreÅ›Ä‡ pierwszej zakÅ‚adki</p>
      </PanelBody>
    </InspectorControls>
    // Kod spisu treÅ›ci...
```

Za sprawÄ… powyÅ¼szego kodu, po klikniÄ™ciu w nasz spis treÅ›ci w edytorze, zobaczymy nastÄ™pujÄ…cÄ… treÅ›Ä‡ w obrÄ™bie sidebara:

![Panel](./panel-boczny-po-dodaniu-tresci.jpg)

Wydaje mi siÄ™, Å¼e powyÅ¼szego kodu nie ma co mocniej opisywaÄ‡ - wszystko jest tam intuicyjne âœ¨

Ale! Na pewno mogÄ™ wspomnieÄ‡ jeszcze jakie atrybuty moÅ¼e przyjÄ…Ä‡ komponent `<PanelBody />`:

- `title` - tytuÅ‚ zakÅ‚adki, uÅ¼yty powyÅ¼ej;
- `opened` - nadpisuje wartoÅ›Ä‡ z atrybutu `initialOpen` oraz gdy ustawimy go na `true`, to caÅ‚a zakÅ‚adka nie bÄ™dzie moÅ¼liwa do zamkniÄ™cia (analogicznie z `false`);
- `className` - klasa dodana do elementu `.components-panel__body`, wyrzucanego przez komponent `<PanelBody />`;
- `icon` - ikonka, ktÃ³ra pokaÅ¼e siÄ™ obok tytuÅ‚u; moÅ¼e to byÄ‡ [dashikonka](https://developer.wordpress.org/resource/dashicons) lub kod komponentu naszej ikony;
- `onToggle` - funkcja, ktÃ³ra wykona siÄ™ przy okazji otwierania oraz zamykania panelu;
- `initialOpen` - czy zakÅ‚adka jest otwarta? DomyÅ›lnie tak, dlatego domyÅ›lnÄ… wartoÅ›ciÄ… jest `true`.

## I tak naprawdÄ™ to byÅ‚oby na tyle!

Na ten moment, wszystko co musisz wiedzieÄ‡ to fakt, Å¼e w `<PanelBody />` moÅ¼esz wrzuciÄ‡ jakikolwiek kod [JSX](https://reactjs.org/docs/introducing-jsx.html) - w tym tonÄ™ wbudowanych komponentÃ³w Gutenberga, idealnie pasujÄ…cych do sidebara.

DokÅ‚adnie to zrobimy w nastÄ™pnej czÄ™Å›ci tej serii.

## WiÄ™c na koniec - zadanie domowe!

Tym razem poproszÄ™ CiÄ™ o pobawienie siÄ™ panelem bocznym, przed przerobieniem nastÄ™pnej czÄ™Å›ci tego kursu.

Zerknij na listÄ™ wszystkich, [wbudowanych komponentÃ³w](https://developer.wordpress.org/block-editor/reference-guides/components), ktÃ³re jesteÅ› w stanie uÅ¼ywaÄ‡ w ramach Gutenberga i sprÃ³buj dodaÄ‡ niektÃ³re z nich do panelu bocznego, a pÃ³Åºniej obsÅ‚uÅ¼yÄ‡ w ramach naszego spisu treÅ›ci (w panelu, jak i na front-endzie).

Nie bÃ³j siÄ™ nieraz popsuÄ‡ kodu i nie bÃ³j siÄ™ zrobiÄ‡ czegoÅ› bardzo, bardzo dziwnego lub nieprzydatnego.

Poeksperymentuj!

Do zobaczenia w nastÄ™pnej czÄ™Å›ci ğŸ˜Œ
